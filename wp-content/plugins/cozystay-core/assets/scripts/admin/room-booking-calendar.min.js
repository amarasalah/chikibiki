!function(s){"use strict";document.addEventListener("DOMContentLoaded",function(){var o,a=loftoceanBookingCalendar.i18nText,n=s("#tab-booking-calendar-panel .booking-calendar-modal"),t=n.find(".booking-calendar-modal-footer .button"),r=n.find(".booking-calendar-modal-content .cs-order-preview"),l=wp.template("loftocean-room-order-details"),e=document.getElementById("booking-calendar"),i=s("#tab-booking-calendar-panel .calendar-loading");function d(e){return 9<e?e:"0"+e}function c(e){var o;void 0!==e.extendedProps.is_booking&&e.extendedProps.is_booking&&(o=e.extendedProps,n.find(".booking-title .order-number").html(o.order_id),(e=l(e=o))&&e.length&&r.html(e),"woocommerce"==o.source?t.attr("href",o.link).show():t.attr("href","#").hide(),n.addClass("show"))}(o=new FullCalendar.Calendar(e,{locale:loftoceanBookingCalendar.locale,timeZone:loftoceanBookingCalendar.timezone,headerToolbar:{left:"today",center:"title",right:"prev,next"},displayEventTime:!0,selectable:!0,fixedWeekCount:!1,eventClick:function({event:e}){c(e)},events:function({start:e,end:o},n,t){e=e.getFullYear()+"-"+d(e.getMonth()+1)+"-"+d(e.getDate()),o=o.getFullYear()+"-"+d(o.getMonth()+1)+"-"+d(o.getDate());i.show(),s.ajax({url:wpApiSettings.root+"loftocean/v1/get_bookings/"+(new Date).getTime(),data:{rid:loftoceanRoomAvailability.roomID,start:e,end:o},type:"POST",success:function(e){"object"==typeof e&&n(e),i.hide()},error:function(e){console.log(a.errorMessage),i.hide()}})},eventContent:function(e){var o=s("<div>",{class:"fc-content"});return e.event.extendedProps.is_booking&&o.html('<div class="order-summary">'+e.event.title+"</div>"),{domNodes:[o.get(0)]}},dayMaxEvents:!0})).render(),n.on("click",".modal-close",function(e){e.preventDefault(),n.removeClass("show")}).on("click",".booking-calendar-modal-bg-overlay",function(e){e.preventDefault(),n.removeClass("show")}),s(document).on("render.loftocean.bookingCalendar",function(e){o.trigger("_resize")}).on("refresh.loftocean.bookingCalendar",function(e){o.refetchEvents()})})}(jQuery);
