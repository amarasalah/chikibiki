!function(a){"use strict";var t,o,n,i,e,l,s,r=a(".loftocean-room-rules-wrapper");function d(e){var t;e&&e.length&&(t=e.find(".date-picker"),e=e.find("select.multiple-choices"),t.length&&t.datepicker({dateFormat:"yy-mm-dd",minDate:0}),e.length&&e.select2({width:"100%"}))}r.length&&(t=r.find(".loftocean-room-rules-add"),o=wp.template("loftocean-room-rule-item"),n=wp.template("loftocean-room-rule-custom-long-stay-item"),i=r.siblings("[name=loftocean_room_rules_removed]"),e=a(".submit.loftocean-submit-button #submit"),l={booking:{term_id:"",title:"",time_range:"",start_date:"",end_date:"",stay_length:{general:{enable:"",min:"",max:""},custom:{enable:"",day0:{min:"",max:""},day1:{min:"",max:""},day2:{min:"",max:""},day3:{min:"",max:""},day4:{min:"",max:""},day5:{min:"",max:""},day6:{min:"",max:""}}},no_checkin_checkout_date:{enable:"",checkin:{day0:"",day1:"",day2:"",day3:"",day4:"",day5:"",day6:""},checkout:{day0:"",day1:"",day2:"",day3:"",day4:"",day5:"",day6:""}},in_advance:{enable:"",min:"",max:""},apply_to:"",apply_to_room_types:[],apply_to_rooms:[]},"flexible-price":{term_id:"",title:"",time_range:"",start_date:"",end_date:"",special_price:{operator:"-",amount:"0"},long_stay_discount:{enable:"",weekly:10,monthly:15},custom_long_stay_discount:{enable:"",items:[{days:"",off:""}]},early_bird_discount:{enable:"",days_before:90,discount:""},last_minute_discount:{enable:"",days_before:"7",discount:""},apply_to:"",apply_to_room_types:[],apply_to_rooms:[]}},r.on("click",".loftocean-room-rules-item-remove",function(e){e.preventDefault();var t=a(this).closest(".loftocean-room-rules-item"),o=t.find(".room-rules-item-id-hidden");o.length&&o.val()&&(e=o.val(),(o=(o=i.val())?o.split(","):[]).push(e),i.val(o.join(","))),t.remove()}).on("keyup",".loftocean-room-rules-title",function(e){var t=a(this).closest(".loftocean-room-rules-item").find("h3 .item-name"),o=a(this).val();t.length&&(o?t.html(" - "+o):t.html(""))}).on("change",".option-title-with-toggle input[type=checkbox]",function(e){var t=a(this).parent().siblings(".option-content-after-toggle");t.length&&(a(this).is(":checked")?t.removeClass("hide"):t.addClass("hide"))}).on("change",".apply-rule-to",function(e){var t=a(this),o=t.val(),n=t.siblings(".sub-options");n.length&&(n.addClass("hide"),o&&t.siblings(".loftocean-"+o).length&&t.siblings(".loftocean-"+o).removeClass("hide"))}).on("change",".loftocean-time-range-select",function(e){var t=a(this).closest(".control-wrapper").siblings(".control-wrapper.loftocean-custom-date-range");t.length&&(a(this).val()?(t.removeClass("hide"),t.find("label").append('<span class="required"> *</span>'),t.find("input").attr("required","required")):(t.addClass("hide"),t.find(".required").remove(),t.find("input").removeAttr("required")))}).on("click",".add-custom-custom-long-stay",function(e){e.preventDefault();var t=a(this).closest(".option-content-after-toggle"),e=n({namePrefix:t.data("name-prefix")});e&&t.append(e)}).on("click",".delete-custom-custom-long-stay",function(e){e.preventDefault();e=a(this).closest(".multi-items-wrapper");e.siblings().length?e.remove():e.find("input").val("")}),t.on("click",function(e){e.preventDefault(),void 0===(e=t.data("rule-type"))||"undefined"==l[e]||(e=o({index:t.data("current-index"),list:[l[e]]}))&&(e=a(e),t.before(e),d(e)),t.data("current-index",1+t.data("current-index"))}),(s=!!loftoceanRoomRules&&(Array.isArray(loftoceanRoomRules)?loftoceanRoomRules:"object"==typeof loftoceanRoomRules&&Object.values(loftoceanRoomRules)))&&s.length&&((s=o({index:0,list:s}))&&(s=a(s),t.before(s),t.data("current-index",s.length),d(s))),r.sortable({items:"> .loftocean-room-rules-item"}).on("dblclick",".loftocean-room-rules-item > h3",function(e){var t=a(this).siblings(".loftocean-room-rules-controls-wrapper");t.length&&t.toggle()}),e.length&&e.removeAttr("disabled").siblings(".spinner").css("visibility","hidden"))}(jQuery);