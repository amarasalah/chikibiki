!function(s){"use strict";s(document).ready(function(){var n={input:"",frames:{},videoFrame:function(){return this.frames.video||(this.frames.video=wp.media({id:"loftocean-video-media-library",editing:!0,library:{type:"video"},multiple:!1}).on("select",function(){var e=n.frames.video.state().get("selection").first().toJSON();n.input.val(e.url),n.input=""}).on("open",function(){n.frames.video.state().get("selection").reset()})),this.frames.video},imageFrame:function(){return this.frames.image||(this.frames.image=wp.media({id:"loftocean-image-media-library",editing:!0,library:{type:"image"},multiple:!1}).on("select",function(){var e=n.frames.image.state().get("selection").first().toJSON(),i=(e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail:e).url;n.input.val(e.id).trigger("changed.loftocean.media",[i]),n.input=""}).on("open",function(){var e=n.frames.image.state().get("selection"),i=n.input.val();e.reset(),i&&""!==i&&((i=wp.media.attachment(i)).fetch(),e.add(i?[i]:[]))})),this.frames.image},imageWithSizeFrame:function(){return this.frames.imageWithSize||(this.frames.imageWithSize=new wp.media({id:"loftocean-image-with-size-media-library",editing:!0,library:{type:"image"},multiple:!1,frame:"post",state:"image"}).on("select",function(){var e=n.frames.image.state().get("selection").first().toJSON(),i=(e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail:e).url;n.input.val(e.id).trigger("changed.loftocean.media",[i]),n.input=""}).on("open",function(){var e=n.frames.imageWithSize.state().get("selection"),i=n.input.val();e.reset(),i&&""!==i&&((i=wp.media.attachment(i)).fetch(),e.add(i?[i]:[]))})),this.frames.imageWithSize},galleryFrame:function(){return this.frames.gallery||(this.frames.gallery=new wp.media({id:"loftocean-gallery-media-library",editing:!0,library:{type:"image"},multiple:!0,frame:"post",state:"gallery-edit",title:wp.media.view.l10n.editGalleryTitle,"media-sidebar":!0}).on("update",function(e){var i=n.frames.gallery.state(),t=n.frames.gallery.states.get("gallery-edit").get("library"),a=t.pluck("id").join(","),t=t.map(function(e){return((e=e.toJSON()).sizes&&e.sizes.thumbnail?e.sizes.thumbnail:e).url});(e=e||i.get("selection"))&&n.input.val(a).trigger("changed.loftocean.media",[t])}).on("open",function(){var i=n.frames.gallery.states.get("gallery-edit").get("library"),e=n.input.val();i.reset(),e&&(e=e.split(",")).forEach(function(e){e=wp.media.attachment(e);e.fetch(),i.add(e?[e]:[])})})),this.frames.gallery},open:function(e,i){if(this.input=e,i)switch(i){case"gallery":this.galleryFrame().open();break;case"video":this.videoFrame().open();break;default:this.imageFrame().open()}else this.imageFrame().open()}};s("body").on("click",".loftocean-upload-image",function(e){e.preventDefault(),n.open(s(this).siblings("input[type=hidden]").first())}).on("click",".loftocean-remove-image",function(e){e.preventDefault();e=s(this).siblings(".loftocean-upload-image").first();s(this).siblings("input[type=hidden]").first().val(0).trigger("change"),s(this).css("display","none"),e.text(e.attr("data-upload"))}).on("changed.loftocean.media","input.loftocean-image-hidden",function(e,i){var t=s(this).data("width")?s(this).data("width"):"50%";s(this).siblings(".loftocean-upload-image").html(s("<img>",{src:i,style:"max-width: "+t})).siblings(".loftocean-remove-image").css("display","block")}).on("click",".button.choose-media, .media-preview",function(e){e.preventDefault();var i=s(this),e=(i.hasClass("media-preview")?i:i.parent()).siblings("input[type=hidden]");n.open(e.first(),i.parents(".gallery-wrap").length?"gallery":"image")}).on("click",".button.remove-media",function(e){e.preventDefault();var i=s(this),t=i.parent(),e=t.siblings(".media-preview");i.removeClass("not-selected").addClass("selected"),t.siblings("input[type=hidden]").val("").first().trigger("change"),e.html("").append(s("<div>",{class:"placeholder",text:e.attr("data-text-preview")}))}).on("changed.loftocean.media","input.loftocean-gallery-hidden",function(e,i){var t,a,n;e.preventDefault(),i&&s.isArray(i)&&i.length&&(n=s(this),t=i.map(function(e){return s("<img>",{src:e,style:"height: 100px; width: auto;"})}),a=n.siblings(".media-preview"),e=n.siblings(".media-buttons"),a.html("").append(t),e.children(".button.remove-media").removeClass("selected").addClass("not-selected"),(n=n.siblings(".loftocean-gallery-urls")).length&&n.val(JSON.stringify(i)))}).on("click",".loftocean-shortcode-generator-body .loftocean-media",function(e){e.preventDefault();e=s(this).hasClass("video")?"video":"image";n.open(s(this).parent().siblings("input.video-media-input").first(),e)}).on("changed.loftocean.media",".loftocean-shortcode-generator-body .video-media-input",function(e,i){s(this).siblings("p").first().before(s("<p>").append(s("<img>",{src:i})))}).on("changed.loftocean.media","input.loftocean-new-image-hidden",function(e,i){var t,a;i&&(a=s(this),t=s("<img>",{src:i,style:"height: 100px; width: auto;"}),i=a.siblings(".media-preview"),a=a.siblings(".media-buttons"),i.html("").append(t),a.children(".button.remove-media").removeClass("selected").addClass("not-selected"))}),s("input[value=add-tag]").length&&s(".term-img-wrap").length&&s(document).ajaxComplete(function(e,i,t){i&&4===i.readyState&&200===i.status&&i.responseXML&&((i=wpAjax.parseAjaxResponse(i.responseXML,"ajax-response"))&&!i.errors&&s(".term-img-wrap").length&&s(".term-img-wrap").find(".loftocean-remove-image").length&&s(".term-img-wrap").find(".loftocean-remove-image").trigger("click"))})})}(jQuery);
