!function(r){"use strict";var t,o,i,e,a,c,n,s=r(".loftocean-room-extra-service-wrapper");function l(e){var t=a({index:e.data("slot-count"),namePrefix:e.data("name-prefix")});t&&(t=r(t),r(e).append(t),m(t))}function m(e){e&&e.length&&((e=e.find(".date-picker")).length&&e.datepicker({dateFormat:"yy-mm-dd",minDate:0}))}s.length&&(t=s.find(".loftocean-room-extra-service-add"),o=wp.template("loftocean-room-extra-service"),i=s.siblings("[name=loftocean_room_extra_service_removed]"),e=r(".submit.loftocean-submit-button #submit"),a=wp.template("loftocean-room-extra-service-custom-time-slot"),s.on("click",".loftocean-room-extra-service-item-remove",function(e){e.preventDefault();var t=r(this).closest(".loftocean-room-extra-service-item"),o=t.find(".service-item-id-hidden");o.length&&o.val()&&(e=o.val(),(o=(o=i.val())?o.split(","):[]).push(e),i.val(o.join(","))),t.remove()}).on("keyup",".loftocean-room-extra-service-title",function(e){var t=r(this).closest(".loftocean-room-extra-service-item").find("h3 .item-name"),o=r(this).val();t.length&&(o?t.html(" - "+o):t.html(""))}).on("change",".loftocean-room-extra-service-method",function(e){var t=r(this).closest(".control-wrapper"),o=t.siblings(".control-auto-calculated-item"),i=t.siblings(".control-custom-item"),t=t.siblings(".control-auto-calculated-price-item");switch(r(this).val()){case"fixed":o.hide(),i.hide();break;case"auto":o.show(),i.hide();break;case"custom":case"auto_custom":o.hide(),i.show()}t.length&&("auto"==r(this).val()&&["person","night-person"].includes(o.find(".loftocean-room-extra-service-auto-method").val())?t.show():t.hide())}).on("change",".loftocean-room-extra-service-auto-method",function(){var e=r(this),t=e.closest(".control-wrapper").siblings(".control-auto-calculated-price-item");t.length&&(["person","night-person"].includes(e.val())?t.show():t.hide())}).on("change",".effective-time",function(){var e=r(this).closest(".controls-row").find(".custom-effective-time-slots-wrapper");""==r(this).val()?e.hide():e.show()}).on("click",".custom-effective-time-slots-wrapper .add-custom-effective-time-slot",function(e){e.preventDefault();e=r(this).closest(".custom-effective-time-slots-wrapper");return e.data("slot-count",e.data("slot-count")+1),l(e),!1}).on("click",".custom-effective-time-slots-wrapper .delete-custom-effective-time-slot",function(e){e.preventDefault();var t=r(this).parent(),e=t.parent();return t.remove(),e.children().length||(e.data("slot-count",e.data("slot-count")+1),l(e)),!1}),t.on("click",function(e){e.preventDefault(),(e=o({index:t.data("current-index"),list:[{name:"",price:"",method:"fixed",auto_method:"",custom_price_appendix_text:"Per Person",custom_minimum_quantity:"",custom_maximum_quantity:"",custom_adult_price:"",custom_child_price:"",effective_time:"",custom_effective_time_slots:[],obligatory:"",term_id:""}]}))&&(e=r(e),t.before(e),m(e)),t.data("current-index",1+t.data("current-index"))}),!(c=!!loftoceanRoomExtraServices&&(Array.isArray(loftoceanRoomExtraServices)?loftoceanRoomExtraServices:"object"==typeof loftoceanRoomExtraServices&&Object.values(loftoceanRoomExtraServices)))||(n=o({index:0,list:c}))&&(n=r(n),t.before(n),t.data("current-index",c.length),m(n)),s.sortable({items:"> .loftocean-room-extra-service-item"}).on("dblclick",".loftocean-room-extra-service-item > h3",function(e){var t=r(this).siblings(".loftocean-room-extra-service-controls-wrapper");t.length&&t.toggle()}),e.length&&e.removeAttr("disabled").siblings(".spinner").css("visibility","hidden"))}(jQuery);
